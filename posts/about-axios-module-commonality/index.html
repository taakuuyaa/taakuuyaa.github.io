<!doctype html><html lang=ja dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>@nuxt/axiosを使ったAPI呼び出し共通化について | taakuuyaa's Blog</title><meta name=keywords content="axios,Nuxt"><meta name=description content="はじめに Nuxt.jsで@nuxt/axios(axios-module)を使いSSR・Store・コンポーネントなどの 様々なコンテキストに対応するaxiosの共通化に少し癖があったので備忘録として残します。
なぜ共通化するのか？  エンドポイントの修正による変更が大変
あちこちで↓のようなコードが呼ばれていると検索・置換を使って修正するしかない。  this.$axios.$get('https://example.com/api/users')  ヘッダー等に付与する情報を適宜変更したい 可読性が上がる
axiosの処理を↓のように呼び出せるようになると見やすい  this.$axios.$get('https://example.com/api/users') // ↓ 変更 api.getUsers() etc&mldr;
共通化の方法について 調査してみるとプラグイン初期化のタイミングでアクセスできる$axiosをexportしている例をよく見かけました。
 Nuxt.jsでaxiosの共通処理を作成し、API呼び出し処理をラップして使用する
https://qiita.com/itouuuuuuuuu/items/4132e3b7ddf2cbf02442
 axios-moduleのissueにも共通化に関するものがあったので参考に実装してみました。
 Can I use axios-module in non-vue files? #28
https://github.com/nuxt-community/axios-module/issues/28#issuecomment-340743659
 実際にうまく動いているように思えましたが一つ問題がありました。
リクエストヘッダーにはセッションごとに違うトークンを付与して、 サーバ側で実行されるフック(fetch/asyncData)でリクエストを行う実装を行いました。
複数のブラウザ（セッションがことなる）で同時にリクエストをしたところ 後からリクエストしたレスポンスで返されるべき情報が返されてしまいました。
この現象について調べてみたところ以下のissueが参考なりました。
 axios module: axios.setToken where to run? #298
https://github.com/nuxt-community/axios-module/issues/298#issuecomment-318165164
 どうやら$axiosはグローバルとして定義され同時リクエスト時に共有されるため、 import/exportすることは推奨されていないようでした。
さらに調査して以下の方法にたどり着きました。
 How to import module to external file #101
https://github.com/nuxt-community/axios-module/issues/101#issuecomment-365909923
  Organize and decouple your API calls in Nuxt."><meta name=author content="taakuuyaa"><link rel=canonical href=https://taakuuyaa.github.io/posts/about-axios-module-commonality/><link href=/assets/css/stylesheet.min.d6b9f5b9a35628f539baeea5ef9a5a2774bbbe4a533799274b9dc35ea1691b4f.css integrity="sha256-1rn1uaNWKPU5uu6l75paJ3S7vkpTN5knS53DXqFpG08=" rel="preload stylesheet" as=style><link rel=icon href=https://taakuuyaa.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://taakuuyaa.github.io/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://taakuuyaa.github.io/favicon.ico><link rel=apple-touch-icon href=https://taakuuyaa.github.io/apple-touch-icon-180x180.png><link rel=mask-icon href=https://taakuuyaa.github.io/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.80.0"><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-187620483-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><meta property="og:title" content="@nuxt/axiosを使ったAPI呼び出し共通化について"><meta property="og:description" content="はじめに Nuxt.jsで@nuxt/axios(axios-module)を使いSSR・Store・コンポーネントなどの 様々なコンテキストに対応するaxiosの共通化に少し癖があったので備忘録として残します。
なぜ共通化するのか？  エンドポイントの修正による変更が大変
あちこちで↓のようなコードが呼ばれていると検索・置換を使って修正するしかない。  this.$axios.$get('https://example.com/api/users')  ヘッダー等に付与する情報を適宜変更したい 可読性が上がる
axiosの処理を↓のように呼び出せるようになると見やすい  this.$axios.$get('https://example.com/api/users') // ↓ 変更 api.getUsers() etc&mldr;
共通化の方法について 調査してみるとプラグイン初期化のタイミングでアクセスできる$axiosをexportしている例をよく見かけました。
 Nuxt.jsでaxiosの共通処理を作成し、API呼び出し処理をラップして使用する
https://qiita.com/itouuuuuuuuu/items/4132e3b7ddf2cbf02442
 axios-moduleのissueにも共通化に関するものがあったので参考に実装してみました。
 Can I use axios-module in non-vue files? #28
https://github.com/nuxt-community/axios-module/issues/28#issuecomment-340743659
 実際にうまく動いているように思えましたが一つ問題がありました。
リクエストヘッダーにはセッションごとに違うトークンを付与して、 サーバ側で実行されるフック(fetch/asyncData)でリクエストを行う実装を行いました。
複数のブラウザ（セッションがことなる）で同時にリクエストをしたところ 後からリクエストしたレスポンスで返されるべき情報が返されてしまいました。
この現象について調べてみたところ以下のissueが参考なりました。
 axios module: axios.setToken where to run? #298
https://github.com/nuxt-community/axios-module/issues/298#issuecomment-318165164
 どうやら$axiosはグローバルとして定義され同時リクエスト時に共有されるため、 import/exportすることは推奨されていないようでした。
さらに調査して以下の方法にたどり着きました。
 How to import module to external file #101
https://github.com/nuxt-community/axios-module/issues/101#issuecomment-365909923
  Organize and decouple your API calls in Nuxt."><meta property="og:type" content="article"><meta property="og:url" content="https://taakuuyaa.github.io/posts/about-axios-module-commonality/"><meta property="article:published_time" content="2021-02-05T00:00:00+09:00"><meta property="article:modified_time" content="2021-02-05T00:00:00+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="@nuxt/axiosを使ったAPI呼び出し共通化について"><meta name=twitter:description content="はじめに Nuxt.jsで@nuxt/axios(axios-module)を使いSSR・Store・コンポーネントなどの 様々なコンテキストに対応するaxiosの共通化に少し癖があったので備忘録として残します。
なぜ共通化するのか？  エンドポイントの修正による変更が大変
あちこちで↓のようなコードが呼ばれていると検索・置換を使って修正するしかない。  this.$axios.$get('https://example.com/api/users')  ヘッダー等に付与する情報を適宜変更したい 可読性が上がる
axiosの処理を↓のように呼び出せるようになると見やすい  this.$axios.$get('https://example.com/api/users') // ↓ 変更 api.getUsers() etc&mldr;
共通化の方法について 調査してみるとプラグイン初期化のタイミングでアクセスできる$axiosをexportしている例をよく見かけました。
 Nuxt.jsでaxiosの共通処理を作成し、API呼び出し処理をラップして使用する
https://qiita.com/itouuuuuuuuu/items/4132e3b7ddf2cbf02442
 axios-moduleのissueにも共通化に関するものがあったので参考に実装してみました。
 Can I use axios-module in non-vue files? #28
https://github.com/nuxt-community/axios-module/issues/28#issuecomment-340743659
 実際にうまく動いているように思えましたが一つ問題がありました。
リクエストヘッダーにはセッションごとに違うトークンを付与して、 サーバ側で実行されるフック(fetch/asyncData)でリクエストを行う実装を行いました。
複数のブラウザ（セッションがことなる）で同時にリクエストをしたところ 後からリクエストしたレスポンスで返されるべき情報が返されてしまいました。
この現象について調べてみたところ以下のissueが参考なりました。
 axios module: axios.setToken where to run? #298
https://github.com/nuxt-community/axios-module/issues/298#issuecomment-318165164
 どうやら$axiosはグローバルとして定義され同時リクエスト時に共有されるため、 import/exportすることは推奨されていないようでした。
さらに調査して以下の方法にたどり着きました。
 How to import module to external file #101
https://github.com/nuxt-community/axios-module/issues/101#issuecomment-365909923
  Organize and decouple your API calls in Nuxt."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"@nuxt/axiosを使ったAPI呼び出し共通化について","name":"@nuxt\/axiosを使ったAPI呼び出し共通化について","description":"はじめに Nuxt.jsで@nuxt/axios(axios-module)を使いSSR・Store・コンポーネントなどの 様々なコンテキストに対応するaxiosの共通化に少し癖があったので備忘録として残します。\nなぜ共通化するのか？  エンドポイントの修正による変更が大変\nあちこちで↓のようなコードが呼ばれていると検索・置換を使って修正するしかない。 …","keywords":["axios","Nuxt"],"articleBody":"はじめに Nuxt.jsで@nuxt/axios(axios-module)を使いSSR・Store・コンポーネントなどの 様々なコンテキストに対応するaxiosの共通化に少し癖があったので備忘録として残します。\nなぜ共通化するのか？  エンドポイントの修正による変更が大変\nあちこちで↓のようなコードが呼ばれていると検索・置換を使って修正するしかない。  this.$axios.$get('https://example.com/api/users')  ヘッダー等に付与する情報を適宜変更したい 可読性が上がる\naxiosの処理を↓のように呼び出せるようになると見やすい  this.$axios.$get('https://example.com/api/users') // ↓ 変更 api.getUsers() etc…\n共通化の方法について 調査してみるとプラグイン初期化のタイミングでアクセスできる$axiosをexportしている例をよく見かけました。\n Nuxt.jsでaxiosの共通処理を作成し、API呼び出し処理をラップして使用する\nhttps://qiita.com/itouuuuuuuuu/items/4132e3b7ddf2cbf02442\n axios-moduleのissueにも共通化に関するものがあったので参考に実装してみました。\n Can I use axios-module in non-vue files? #28\nhttps://github.com/nuxt-community/axios-module/issues/28#issuecomment-340743659\n 実際にうまく動いているように思えましたが一つ問題がありました。\nリクエストヘッダーにはセッションごとに違うトークンを付与して、 サーバ側で実行されるフック(fetch/asyncData)でリクエストを行う実装を行いました。\n複数のブラウザ（セッションがことなる）で同時にリクエストをしたところ 後からリクエストしたレスポンスで返されるべき情報が返されてしまいました。\nこの現象について調べてみたところ以下のissueが参考なりました。\n axios module: axios.setToken where to run? #298\nhttps://github.com/nuxt-community/axios-module/issues/298#issuecomment-318165164\n どうやら$axiosはグローバルとして定義され同時リクエスト時に共有されるため、 import/exportすることは推奨されていないようでした。\nさらに調査して以下の方法にたどり着きました。\n How to import module to external file #101\nhttps://github.com/nuxt-community/axios-module/issues/101#issuecomment-365909923\n  Organize and decouple your API calls in Nuxt.js\nhttps://blog.lichter.io/posts/nuxt-api-call-organization-and-decoupling/\n api用の別プラグインを定義してそこに$axiosインスタンスを注入する方法でした。\n// api/apiFactory.js export default $axios = ({ getUsers() { return $axios.$get('https://example.com/api/users') }, }) // plugins/api.js import { apiFactory } from '~/api/apiFactory' export default ({ $axios }, inject) = { const api = apiFactory($axios) inject(\"api\", api) } さいごに axios-moduleは普通axiosと違いNuxtに統合されたaxiosのため、 import/exportして使うやり方が推奨されないなどの拡張/共通化することに癖がありました。 また、共通化する場合はどのコンテキスト（SSR/CSR/Store/Component）でも呼ばれることを考慮しなければならないので少し大変でした。\n","wordCount":"106","inLanguage":"ja","datePublished":"2021-02-05T00:00:00+09:00","dateModified":"2021-02-05T00:00:00+09:00","author":{"@type":"Person","name":"taakuuyaa"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://taakuuyaa.github.io/posts/about-axios-module-commonality/"},"publisher":{"@type":"Organization","name":"taakuuyaa's Blog","logo":{"@type":"ImageObject","url":"https://taakuuyaa.github.io/favicon.ico"}}}</script></head><body id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><noscript><style type=text/css>.theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://taakuuyaa.github.io/ accesskey=h title="taakuuyaa's Blog (Alt + H)">taakuuyaa's Blog</a>
<span class=logo-switches><span class=theme-toggle title="(Alt + T)"><a id=theme-toggle accesskey=t><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></a></span></span></div><ul class=menu id=menu onscroll=menu_on_scroll()><li><a href=https://taakuuyaa.github.io/ title=Home><span>Home</span></a></li><li><a href=https://taakuuyaa.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://taakuuyaa.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://taakuuyaa.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://taakuuyaa.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>@nuxt/axiosを使ったAPI呼び出し共通化について</h1><div class=post-description></div><div class=post-meta>February 5, 2021&nbsp;·&nbsp;1 min&nbsp;·&nbsp;taakuuyaa</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><blockquote><ul><li><a href=#%e3%81%af%e3%81%98%e3%82%81%e3%81%ab aria-label=はじめに>はじめに</a></li><li><a href=#%e3%81%aa%e3%81%9c%e5%85%b1%e9%80%9a%e5%8c%96%e3%81%99%e3%82%8b%e3%81%ae%e3%81%8b aria-label=なぜ共通化するのか？>なぜ共通化するのか？</a></li><li><a href=#%e5%85%b1%e9%80%9a%e5%8c%96%e3%81%ae%e6%96%b9%e6%b3%95%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6 aria-label=共通化の方法について>共通化の方法について</a></li><li><a href=#%e3%81%95%e3%81%84%e3%81%94%e3%81%ab aria-label=さいごに>さいごに</a></li></ul></blockquote></details></div><div class=post-content><h2 id=はじめに>はじめに<a hidden class=anchor aria-hidden=true href=#はじめに>#</a></h2><p>Nuxt.jsで@nuxt/axios(axios-module)を使いSSR・Store・コンポーネントなどの
様々なコンテキストに対応するaxiosの共通化に少し癖があったので備忘録として残します。</p><h2 id=なぜ共通化するのか>なぜ共通化するのか？<a hidden class=anchor aria-hidden=true href=#なぜ共通化するのか>#</a></h2><ul><li>エンドポイントの修正による変更が大変<br>あちこちで↓のようなコードが呼ばれていると検索・置換を使って修正するしかない。</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>$axios</span>.<span style=color:#a6e22e>$get</span>(<span style=color:#e6db74>&#39;https://example.com/api/users&#39;</span>)
</code></pre></div><ul><li>ヘッダー等に付与する情報を適宜変更したい</li><li>可読性が上がる<br>axiosの処理を↓のように呼び出せるようになると見やすい</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>$axios</span>.<span style=color:#a6e22e>$get</span>(<span style=color:#e6db74>&#39;https://example.com/api/users&#39;</span>)
<span style=color:#75715e>// ↓ 変更
</span><span style=color:#75715e></span><span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>getUsers</span>()
</code></pre></div><p>etc&mldr;</p><h2 id=共通化の方法について>共通化の方法について<a hidden class=anchor aria-hidden=true href=#共通化の方法について>#</a></h2><p>調査してみるとプラグイン初期化のタイミングでアクセスできる<code>$axios</code>をexportしている例をよく見かけました。</p><blockquote><p>Nuxt.jsでaxiosの共通処理を作成し、API呼び出し処理をラップして使用する<br><a href=https://qiita.com/itouuuuuuuuu/items/4132e3b7ddf2cbf02442>https://qiita.com/itouuuuuuuuu/items/4132e3b7ddf2cbf02442</a></p></blockquote><p>axios-moduleのissueにも共通化に関するものがあったので参考に実装してみました。</p><blockquote><p>Can I use axios-module in non-vue files? #28<br><a href=https://github.com/nuxt-community/axios-module/issues/28#issuecomment-340743659>https://github.com/nuxt-community/axios-module/issues/28#issuecomment-340743659</a></p></blockquote><p>実際にうまく動いているように思えましたが一つ問題がありました。</p><p>リクエストヘッダーにはセッションごとに違うトークンを付与して、
サーバ側で実行されるフック(fetch/asyncData)でリクエストを行う実装を行いました。<br>複数のブラウザ（セッションがことなる）で同時にリクエストをしたところ
後からリクエストしたレスポンスで返されるべき情報が返されてしまいました。</p><p>この現象について調べてみたところ以下のissueが参考なりました。</p><blockquote><p>axios module: axios.setToken where to run? #298<br><a href=https://github.com/nuxt-community/axios-module/issues/298#issuecomment-318165164>https://github.com/nuxt-community/axios-module/issues/298#issuecomment-318165164</a></p></blockquote><p>どうやら$axiosはグローバルとして定義され同時リクエスト時に共有されるため、
import/exportすることは推奨されていないようでした。</p><p>さらに調査して以下の方法にたどり着きました。</p><blockquote><p>How to import module to external file #101<br><a href=https://github.com/nuxt-community/axios-module/issues/101#issuecomment-365909923>https://github.com/nuxt-community/axios-module/issues/101#issuecomment-365909923</a></p></blockquote><blockquote><p>Organize and decouple your API calls in Nuxt.js<br><a href=https://blog.lichter.io/posts/nuxt-api-call-organization-and-decoupling/>https://blog.lichter.io/posts/nuxt-api-call-organization-and-decoupling/</a></p></blockquote><p>api用の別プラグインを定義してそこに$axiosインスタンスを注入する方法でした。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#75715e>// api/apiFactory.js
</span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>$axios</span> =&gt; ({
  <span style=color:#a6e22e>getUsers</span>() {
    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>$axios</span>.<span style=color:#a6e22e>$get</span>(<span style=color:#e6db74>&#39;https://example.com/api/users&#39;</span>)
  },
})
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#75715e>// plugins/api.js
</span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>apiFactory</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;~/api/apiFactory&#39;</span>

<span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> ({ <span style=color:#a6e22e>$axios</span> }, <span style=color:#a6e22e>inject</span>) =&gt; {
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>api</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>apiFactory</span>(<span style=color:#a6e22e>$axios</span>)
  <span style=color:#a6e22e>inject</span>(<span style=color:#e6db74>&#34;api&#34;</span>, <span style=color:#a6e22e>api</span>)
}
</code></pre></div><h2 id=さいごに>さいごに<a hidden class=anchor aria-hidden=true href=#さいごに>#</a></h2><p>axios-moduleは普通axiosと違いNuxtに統合されたaxiosのため、
import/exportして使うやり方が推奨されないなどの拡張/共通化することに癖がありました。
また、共通化する場合はどのコンテキスト（SSR/CSR/Store/Component）でも呼ばれることを考慮しなければならないので少し大変でした。</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://taakuuyaa.github.io/tags/axios/>axios</a></li><li><a href=https://taakuuyaa.github.io/tags/nuxt/>Nuxt</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://taakuuyaa.github.io/>taakuuyaa's Blog</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script defer src=/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w=" onload=hljs.initHighlightingOnLoad();></script><script>window.onload=function(){if(localStorage.getItem("menu-scroll-position")){document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position");}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});}else{document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();}
if(id==="top"){history.replaceState(null,null," ");}else{history.replaceState(null,null,`#${id}`);}});});var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft);}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script></body></html>